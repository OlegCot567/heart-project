<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Heart Animation</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  overflow: hidden;
}
canvas {
  display: block;
}
</style>
</head>
<body>

<canvas id="heart"></canvas>

<script>
const canvas = document.getElementById('heart');
const ctx = canvas.getContext('2d');

let width, height;
function resize() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

let particles = [];
let time = 0;

// НАСТРОЙКИ
const settings = {
  particleCount: 700,
  scale: 15,
  traceOpacity: 0.08,
  color: "255,80,150", // RGB
};

// ФОРМУЛА СЕРДЦА
function getHeartPosition(t) {
  return {
    x: 16 * Math.pow(Math.sin(t), 3),
    y: -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t))
  };
}

// ЧАСТИЦА
class Particle {
  constructor(i) {
    this.angle = Math.random() * Math.PI * 2;
    this.speed = 0.001 + Math.random() * 0.003;
    this.x = width / 2;
    this.y = height / 2;
    this.vx = 0;
    this.vy = 0;
    this.spring = 0.008 + Math.random() * 0.01;
    this.friction = 0.88 + Math.random() * 0.08;
  }

  update(pulse) {
    this.angle += this.speed;

    const raw = getHeartPosition(this.angle);
    const tx = width/2 + raw.x * settings.scale * pulse;
    const ty = height/2 + raw.y * settings.scale * pulse;

    const dx = tx - this.x;
    const dy = ty - this.y;

    this.vx += dx * this.spring;
    this.vy += dy * this.spring;

    // микрохаос
    this.vx += (Math.random() - 0.5) * 0.05;
    this.vy += (Math.random() - 0.5) * 0.05;

    this.vx *= this.friction;
    this.vy *= this.friction;

    this.x += this.vx;
    this.y += this.vy;
  }
}

// СОЗДАНИЕ
function init() {
  particles = [];
  for (let i = 0; i < settings.particleCount; i++) {
    particles.push(new Particle(i));
  }
}
init();

// АНИМАЦИЯ
function animate() {
  ctx.fillStyle = `rgba(0,0,0,${settings.traceOpacity})`;
  ctx.fillRect(0,0,width,height);

  time += 0.04;
  const pulse = 1 + Math.sin(time) * 0.07;

  ctx.beginPath();

  particles.forEach(p => {
    p.update(pulse);
    ctx.lineTo(p.x, p.y);
  });

  ctx.strokeStyle = `rgba(${settings.color},0.05)`;
  ctx.lineWidth = 1;
  ctx.shadowBlur = 20;
  ctx.shadowColor = `rgba(${settings.color},0.6)`;
  ctx.stroke();

  ctx.fillStyle = `rgba(${settings.color},0.8)`;
  particles.forEach(p => {
    ctx.fillRect(p.x, p.y, 1.3, 1.3);
  });

  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
